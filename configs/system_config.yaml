# 系统配置文件
# 相机参数（需要根据实际标定结果修改）
camera:
  # 左相机内参矩阵 [3x3]
  left_camera_matrix: [[800, 0, 320], [0, 800, 240], [0, 0, 1]]
  # 右相机内参矩阵 [3x3]
  right_camera_matrix: [[800, 0, 320], [0, 800, 240], [0, 0, 1]]
  # 左相机畸变系数 [k1, k2, p1, p2, k3]
  left_dist_coeffs: [0.0, 0.0, 0.0, 0.0, 0.0]
  # 右相机畸变系数
  right_dist_coeffs: [0.0, 0.0, 0.0, 0.0, 0.0]
  # 立体校正参数
  stereo:
    # 旋转矩阵 R [3x3]
    R: [[1, 0, 0], [0, 1, 0], [0, 0, 1]]
    # 平移向量 T [3x1]
    T: [0.12, 0, 0]  # 基线距离12cm
    # 左相机校正矩阵
    R1: [[1, 0, 0], [0, 1, 0], [0, 0, 1]]
    # 右相机校正矩阵
    R2: [[1, 0, 0], [0, 1, 0], [0, 0, 1]]
    # 投影矩阵
    P1: [[800, 0, 320, 0], [0, 800, 240, 0], [0, 0, 1, 0]]
    P2: [[800, 0, 320, -96], [0, 800, 240, 0], [0, 0, 1, 0]]
    # Q矩阵（用于重投影）
    Q: [[1, 0, 0, -320], [0, 1, 0, -240], [0, 0, 0, 800], [0, 0, -8.333333333333334, 0]]
  # 图像分辨率
  image_width: 640
  image_height: 480
  # 焦距（像素）
  focal_length: 800
  # 基线距离（米）
  baseline: 0.12

# 模型路径配置
models:
  # YOLO模型路径（支持.pt, .onnx, .hef格式）
  # 检测类别：person, car, bicycle
  yolo_model: "models/yolo_obstacle.hef"
  # U-Net模型路径（场景分割：路面、车道线、天空等）
  unet_model: "models/unet_obstacle.hef"
  # 输入图像尺寸
  input_size: [640, 480]
  # 置信度阈值
  detection_confidence: 0.5
  # NMS阈值
  nms_threshold: 0.4

# 相机配置（支持4个摄像头：2个双目+2个环视）
cameras:
  # 前向双目相机
  front_stereo:
    left_id: 0
    right_id: 1
  # 环视相机（可选）
  surround:
    front_id: 2
    rear_id: 3

# 立体匹配参数
stereo_matching:
  # SGBM参数
  min_disparity: 0
  num_disparities: 64
  block_size: 11
  P1: 8 * 3 * 11 * 11
  P2: 32 * 3 * 11 * 11
  disp12MaxDiff: 1
  preFilterCap: 63
  uniquenessRatio: 15
  speckleWindowSize: 0
  speckleRange: 0
  mode: "SGBM"

# 碰撞风险评估参数
risk_assessment:
  # 安全距离阈值（米）
  safe_distance: 3.0
  # 警告距离阈值（米）
  warning_distance: 2.0
  # 危险距离阈值（米）
  danger_distance: 1.0
  # 碰撞风险阈值（0-1）
  risk_threshold: 0.7
  # 刹车触发距离（米）
  brake_distance: 0.8

# 道路风险预警参数
road_risk_assessment:
  # 中长期风险阈值
  low_visibility_brightness_threshold: 80      # 低能见度亮度阈值
  low_visibility_contrast_threshold: 30        # 低能见度对比度阈值
  wet_road_texture_threshold: 0.3              # 路面湿滑纹理阈值
  # 短期风险阈值
  curve_curvature_threshold: 0.1               # 弯道曲率阈值
  narrow_road_density_threshold: 0.4           # 狭窄路段密度阈值

# TTC估算参数
ttc_estimation:
  # 默认自车速度（米/秒），如果未提供则使用此值
  default_ego_speed: 5.0
  # 历史记录大小
  history_size: 10
  # 计算TTC所需的最少帧数
  min_frames_for_ttc: 2
  # TTC警告阈值（秒）
  warning_threshold: 5.0
  # TTC紧急警报阈值（秒）
  emergency_threshold: 3.0

# 语音提示参数
voice_alert:
  # 是否启用语音提示
  enabled: true
  # 语言代码
  language: "zh-CN"

# 显示界面参数
display:
  # 窗口尺寸
  window_width: 1280
  window_height: 720
  # 鸟瞰图范围（米）
  bev_range: 10.0
  # 自车位置（像素）
  ego_position: [640, 360]
  # 更新频率（FPS）
  target_fps: 15

# Hailo-8配置
hailo:
  # 是否使用Hailo加速
  enabled: true
  # 设备索引
  device_index: 0
  # 批处理大小
  batch_size: 1

# 系统性能参数
performance:
  # 目标帧率
  target_fps: 15
  # 最大延迟（毫秒）
  max_latency_ms: 150
  # 是否启用多线程
  multi_threading: true
  # 线程数
  num_threads: 4

